---
title: "Milestone Report"
author: "Yasser Gonzalez"
date: "March 20, 2016"
output: html_document
---

```{r}
library("knitr")
library("dplyr")
library("tidyr")
library("R.utils")
library("stringi")
library("ggplot2")

corpus_path <- function(name, lang) {
    stopifnot(name %in% c("blogs", "news", "twitter"))
    stopifnot(lang %in% c("de_DE", "en_US", "fi_FI", "ru_RU"))
    
    data_dir <- "../data"
    lang_dir <- file.path(data_dir, lang)
    text_name <- paste0(lang, ".", name, ".txt")
    text_path <- file.path(lang_dir, text_name)

    text_path
}
```

## Introduction

```{r}
lang <- "en_US"
corpus_names <- c("blogs", "news", "twitter")
```

## Basic Statistics

```{r echo = FALSE}
format_size <- function(file_path) {
    size_in_bytes <- file.size(file_path)
    size_in_mb <- size_in_bytes / 10 ^ 6
    formatC(size_in_mb, format = "f", digits = 2, big.mark = ",")
}

format_lines <- function(file_path) {
    lines <- countLines(file_path)
    prettyNum(lines, big.mark = ",")
}

corpus_results <- function(corpus_name) {
    list(corpus = rep(corpus_name, 2),
         name = c("size", "lines"),
         value = c(format_size(corpus_path(corpus_name, lang)),
                   format_lines(corpus_path(corpus_name, lang))))
}

basic_stats <- do.call(rbind, lapply(lapply(corpus_names, corpus_results), as_data_frame))
kable(basic_stats %>%
    spread(name, value) %>%
    select(Corpus = corpus,
           `File Size (mb)` = size,
           `Number of Lines` = lines))
```

```{r echo = FALSE}
corpus_results <- function(corpus_name) {
    lines <- readLines(corpus_path(corpus_name, lang), encoding = "UTF-8")
    word_count <- stri_count_words(lines)
    word_count_summary <- summary(word_count)

    results <- list(Corpus = corpus_name)
    results <- c(results, lapply(word_count_summary, function(x) x))
    results
}

words_per_line <- do.call(rbind, lapply(lapply(corpus_names, corpus_results), as_data_frame))
kable(words_per_line)
```

## N-Gram Frequency

## Conclusions & Outlook
